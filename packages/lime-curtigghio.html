<!DOCTYPE html>
<html>
  
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-language" content="en">

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>lime-curtigghio | LibreMesh</title>
  <meta name="description" content="">
  <meta name="author" content="LibreMesh">
  <meta name="theme-color" content="black">    
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
  <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="canonical" href="/packages/lime-curtigghio.html">
  <link rel="alternate" type="application/rss+xml" title="LibreMesh" href="/feed.xml">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">      
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">  
  <link rel="shortcut icon" href="/assets/logo/logo_nano.png"> 

  <link rel="stylesheet" href="/assets/css/font-awesome.min.css">
  <link rel="stylesheet" href="/assets/css/asciidoctor.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/palette.css">
  <link rel="stylesheet" href="/assets/css/style.css">
  <script src="/assets/js/main.js"></script>


  <body dir="ltr" data-md-color-primary="black" data-md-color-accent="black" class="no-toc">
    
    <svg class="md-svg">
  <defs>
    <path d="M160 304q0 10-3.125 20.5t-10.75 19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75 19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360 304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25 2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75 1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75 0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5 46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z" fill="currentColor"></path>
  </defs>
</svg>

<input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off>
<input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off>
<label class=md-overlay data-md-component=overlay for=__drawer></label> <a href="#lime-curtigghio" tabindex=1 class=md-skip> Skip to content </a>

<header class=md-header data-md-component=header>
  <nav class="md-header-nav md-grid">
    <div class=md-flex>
      <div class="md-flex__cell md-flex__cell--shrink">
        <a class="md-header-nav__button md-logo" href="" title="LibreMesh">
          <img height="" src="/assets/logo/logo_nano.png" width=""></a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
          <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
          <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> 
              <span class=md-header-nav__topic><a href="">LibreMesh</a></span>
              <span class=md-header-nav__topic>lime-curtigghio</span>
          </div>
      </div>

      <!-- lang --> 
      <div class="md-flex__cell md-flex__cell--shrink md-grid">
        <ul style="display: flex" class="lng md-tabs__list">
          
          
          
          
          
            <li class="md-tabs__item " style="padding: 0 .5rem">
              <a href="/packages/lime-curtigghio.html" class="md-tabs__link en lng-active ">EN</a>
            </li>
          
              </ul>
      </div>
      <!-- fine lang-->

      <div class="md-flex__cell md-flex__cell--shrink">
          
          <label class="md-icon md-icon--search md-header-nav__button" for=__search></label>
          <div class=md-search data-md-component=search role=dialog>
              <label class=md-search__overlay for=__search></label>
              <div class=md-search__inner role=search>
                  <form class=md-search__form name=search>
                      <input type=text class=md-search__input name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active>
                      <label class="md-icon md-search__icon" for=__search></label>
                      <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button>
                  </form>
                  <div class=md-search__output>
                      <div class=md-search__scrollwrap data-md-scrollfix>
                          <div class=md-search-result data-md-component=result>
                              <div class=md-search-result__meta> Type to start searching </div>
                              <ol class=md-search-result__list></ol>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
          
      </div>

      <div class="md-flex__cell md-flex__cell--shrink">
        <div class="md-header-nav__source">
          <a class="md-source" data-md-source="github" href="https://github.com/libremesh/lime-packages" title="Go to repository">
          <div class="md-source__icon" style="padding-top:5px">
            <i class="fa-brands fa-github fa-3x"></i>
          </div>
          <div class="md-source__repository">
            libremesh/lime-packages
          </div></a>
        </div>
      </div>
    </div>
    <div class="top-nav md-flex hs no-scrollbar" style="background-color: #333;">
    <ul class="md-tabs__list">

    <!-- Use the current language and default to english if doc translation is not found -->
    
    
    
    <li class="md-tabs__item ">
        <a class="md-tabs__link" href="/">Home</a>
    </li>

    <!-- Use the current language and default to english if doc translation is not found -->
    
    
    
    <li class="md-tabs__item ">
        <a class="md-tabs__link" href="/about.html">About</a>
    </li>

    <!-- Use the current language and default to english if doc translation is not found -->
    
    
    
    <li class="md-tabs__item ">
        <a class="md-tabs__link" href="/news.html">News</a>
    </li>

    <!-- Use the current language and default to english if doc translation is not found -->
    
    
    
    <li class="md-tabs__item ">
        <a class="md-tabs__link" href="/communication.html">Communication</a>
    </li>

    <!-- Use the current language and default to english if doc translation is not found -->
    
    
    
    <li class="md-tabs__item ">
        <a class="md-tabs__link" href="/getit.html">Get it!</a>
    </li>

    <!-- Use the current language and default to english if doc translation is not found -->
    
    
    
    <li class="md-tabs__item ">
        <a class="md-tabs__link" href="/howitworks.html">How it works</a>
    </li>

    <!-- Use the current language and default to english if doc translation is not found -->
    
    
    
    <li class="md-tabs__item ">
        <a class="md-tabs__link" href="/development.html">Development</a>
    </li>

    </ul>

</div>
  </nav>
</header>


    <div class="md-container"> 
        <main class="md-main">
            <div class="md-main__inner md-grid" data-md-component="container">
              <!-- <div class="intersection-rect"></div>     -->

            <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
  <div class="md-sidebar__scrollwrap">
    <div class="md-sidebar__inner">
      <nav class="md-nav md-nav--primary" data-md-level="0">
        <ul class="md-nav__list" data-md-scrollfix="">

          <li class="md-nav__item caption">
  <strong class="text-grey">Documentation</strong>
</li>
<!-- Use the current language and default to english if doc translation is not found -->
 
    
    
    
      <li class="md-nav__item 
        
        ">
      
        <a class="md-nav__link" href="/docs/">
          <i class="fa fa-book" aria-hidden="true"></i>
          <span>LibreMesh Documentation</span>
        </a>
      
      </li>
  
    
    
    
      <li class="md-nav__item 
         md-nav__item--nested 
        ">
      
        <a class="md-nav__link  " style="display:flex;justify-content: space-between;" 
            href="/docs/en_quick_starting_guide.html">
          <div style="display:flex;justify-content: flex-start;">
            <i class="fa fa-rocket" aria-hidden="true"></i>
            <span>Quick Starting Guide</span>
          </div>
          <span style="text-align: right"><i class="fa fa-chevron-right" aria-hidden="true"></i></span>
        </a>
        <ul class="md-nav__list " data-md-scrollfix="">
          
            
            
            
            <li class="md-nav__item ">
              <a class="md-nav__link" href="/docs/en_connecting_nodes.html"> 
                <span>Connecting to LibreMesh nodes</span>
              </a>
            </li>
          
            
            
            
            <li class="md-nav__item ">
              <a class="md-nav__link" href="/docs/quick_start_guide/en_cli_configuration.html"> 
                <span>CLI configuration</span>
              </a>
            </li>
          
          </ul>
      
      </li>
  
    
    
    
      <li class="md-nav__item 
         md-nav__item--nested 
        ">
      
        <a class="md-nav__link  " style="display:flex;justify-content: space-between;" 
            href="/docs/en_config.html">
          <div style="display:flex;justify-content: flex-start;">
            <i class="fa fa-cogs" aria-hidden="true"></i>
            <span>Configuration</span>
          </div>
          <span style="text-align: right"><i class="fa fa-chevron-right" aria-hidden="true"></i></span>
        </a>
        <ul class="md-nav__list " data-md-scrollfix="">
          
            
            
            
            <li class="md-nav__item ">
              <a class="md-nav__link" href="/docs/configuration/faq-and-recommendations.html"> 
                <span>FAQ and recommendations</span>
              </a>
            </li>
          
            
            
            
            <li class="md-nav__item ">
              <a class="md-nav__link" href="/docs/configuration/lime-example.html"> 
                <span>lime-example</span>
              </a>
            </li>
          
          </ul>
      
      </li>
  
    
    
    
      <li class="md-nav__item 
        
        ">
      
        <a class="md-nav__link" href="/docs/en_changing_network_behavior.html">
          <i class="fa fa-ethernet" aria-hidden="true"></i>
          <span>Change Ethernet config</span>
        </a>
      
      </li>
  
    
    
    
      <li class="md-nav__item 
        
        ">
      
        <a class="md-nav__link" href="/docs/en_change_wifi_behavior.html">
          <i class="fa fa-wifi" aria-hidden="true"></i>
          <span>Change WiFi config</span>
        </a>
      
      </li>
  
    
    
    
      <li class="md-nav__item 
        
        ">
      
        <a class="md-nav__link" href="/docs/en_troubleshooting.html">
          <i class="fa fa-wrench" aria-hidden="true"></i>
          <span>Troubleshooting</span>
        </a>
      
      </li>
  
    
    
    
      <li class="md-nav__item 
         md-nav__item--nested 
        ">
      
        <a class="md-nav__link  " style="display:flex;justify-content: space-between;" 
            href="/docs/hardware/">
          <div style="display:flex;justify-content: flex-start;">
            <i class="fa fa-microchip" aria-hidden="true"></i>
            <span>Hardware</span>
          </div>
          <span style="text-align: right"><i class="fa fa-chevron-right" aria-hidden="true"></i></span>
        </a>
        <ul class="md-nav__list " data-md-scrollfix="">
          
            
            
            
            <li class="md-nav__item ">
              <a class="md-nav__link" href="/docs/hardware/tp-link.html"> 
                <span>tp-link</span>
              </a>
            </li>
          
            
            
            
            <li class="md-nav__item ">
              <a class="md-nav__link" href="/docs/hardware/xiaomi-miwifir3.html"> 
                <span>Xiaomi MiWiFi R3</span>
              </a>
            </li>
          
          </ul>
      
      </li>
  
          



  <li class="md-nav__item 
     md-nav__item--nested  
    
    ">
  
    <a class="md-nav__link  " 
    style="display: flex; justify-content: space-between;" 
    href="/development.html">
      <div>
        <i class="fa fa-brands fa-linux" aria-hidden="true"></i>
        <span>Development</span>
      </div>
      <span style="text-align: right"><i class="fa fa-chevron-right" aria-hidden="true"></i></span>
    </a>
    <ul class="md-nav__list " data-md-scrollfix="">
      
        
        
        
        <li class="md-nav__item ">
          <a class="md-nav__link" href="/development-network_profiles.html"> 
            <span>Network Profiles</span>
          </a>
        </li>
      
        
        
        
        <li class="md-nav__item ">
          <a class="md-nav__link" href="/development-kernel_vermagic.html"> 
            <span>Kernel vermagic</span>
          </a>
        </li>
      
      </ul>
  
  </li>

          <li class="md-nav__item md-nav__item--nested 
 md-nav__item--nested-open ">
  <a class="md-nav__link  " 
    style="display: flex; justify-content: space-between" 
    href="/packages/#">
    <div>
      <i class="fa fa-cube" aria-hidden="true"></i>
      <span>Packages</span>
    </div>
    <span style="text-align: right"><i class="fa fa-chevron-right" aria-hidden="true"></i></span>
  </a>
  <ul class="md-nav__list md-nav__list-open " data-md-scrollfix="">
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/altermundi-grafana.html">
          <span>altermundi-grafana</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/auto-usb-wwan.html">
          <span>auto-usb-wwan</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/babeld-auto-gw-mode.html">
          <span>babeld-auto-gw-mode</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/bandwidth-test.html">
          <span>bandwidth-test</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/batman-adv-auto-gw-mode.html">
          <span>batman-adv-auto-gw-mode</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/bmx7-auto-gw-bw-mode.html">
          <span>bmx7-auto-gw-bw-mode</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/bmx7-auto-gw-mode.html">
          <span>bmx7-auto-gw-mode</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/bmx7-mdns.html">
          <span>bmx7-mdns</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/check-date-http.html">
          <span>check-date-http</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/check-internet.html">
          <span>check-internet</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/cotonete.html">
          <span>cotonete</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/deferrable-reboot.html">
          <span>deferrable-reboot</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/eupgrade.html">
          <span>eupgrade</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/first-boot-wizard.html">
          <span>first-boot-wizard</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/hotplug-initd-services.html">
          <span>hotplug-initd-services</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/packages_list.html">
          <span>packages_list</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-ap-watchping.html">
          <span>lime-ap-watchping</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-app.html">
          <span>lime-app</span>
        </a>
      </li>
    
      <li class="md-nav__item md-nav__item--active ">
        <a class="md-nav__link" href="/packages/lime-curtigghio.html">
          <span>lime-curtigghio</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-debug.html">
          <span>lime-debug</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-docs.html">
          <span>lime-docs</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-eth-config.html">
          <span>lime-eth-config</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-hwd-ground-routing.html">
          <span>lime-hwd-ground-routing</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-hwd-openwrt-wan.html">
          <span>lime-hwd-openwrt-wan</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-hwd-usbradio.html">
          <span>lime-hwd-usbradio</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-hwd-watchcat.html">
          <span>lime-hwd-watchcat</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-proto-anygw.html">
          <span>lime-proto-anygw</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-proto-babeld.html">
          <span>lime-proto-babeld</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-proto-batadv.html">
          <span>lime-proto-batadv</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-proto-bgp.html">
          <span>lime-proto-bgp</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-proto-bmx7.html">
          <span>lime-proto-bmx7</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-proto-olsr.html">
          <span>lime-proto-olsr</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-proto-olsr2.html">
          <span>lime-proto-olsr2</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-proto-olsr6.html">
          <span>lime-proto-olsr6</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-proto-wan.html">
          <span>lime-proto-wan</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-report.html">
          <span>lime-report</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-smart-wifi.html">
          <span>lime-smart-wifi</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/lime-system.html">
          <span>lime-system</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/miniserver-client.html">
          <span>miniserver-client</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/pirania.html">
          <span>pirania</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/prometheus-node-exporter-lua-location-latlon.html">
          <span>prometheus-node-exporter-lua-location-latlon</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/prometheus-node-exporter-lua-wifi-params.html">
          <span>prometheus-node-exporter-lua-wifi-params</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/prometheus-node-exporter-lua-wifi-stations-extra.html">
          <span>prometheus-node-exporter-lua-wifi-stations-extra</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/prometheus-node-exporter-lua-wifi-survey.html">
          <span>prometheus-node-exporter-lua-wifi-survey</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/prometheus-node-push-influx.html">
          <span>prometheus-node-push-influx</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/random-numgen.html">
          <span>random-numgen</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/safe-reboot.html">
          <span>safe-reboot</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/safe-upgrade.html">
          <span>safe-upgrade</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/shared-state-async.html">
          <span>shared-state-async</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/shared-state-babel_links_info.html">
          <span>shared-state-babel_links_info</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/shared-state-babeld_hosts.html">
          <span>shared-state-babeld_hosts</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/shared-state-bat_hosts.html">
          <span>shared-state-bat_hosts</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/shared-state-bat_links_info.html">
          <span>shared-state-bat_links_info</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/shared-state-dnsmasq_hosts.html">
          <span>shared-state-dnsmasq_hosts</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/shared-state-dnsmasq_leases.html">
          <span>shared-state-dnsmasq_leases</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/shared-state-dnsmasq_servers.html">
          <span>shared-state-dnsmasq_servers</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/shared-state-network_nodes.html">
          <span>shared-state-network_nodes</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/shared-state-node_info.html">
          <span>shared-state-node_info</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/shared-state-nodes_and_links.html">
          <span>shared-state-nodes_and_links</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/shared-state-persist.html">
          <span>shared-state-persist</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/shared-state-pirania.html">
          <span>shared-state-pirania</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/shared-state-ref_state_commons.html">
          <span>shared-state-ref_state_commons</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/shared-state-wifi_links_info.html">
          <span>shared-state-wifi_links_info</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/shared-state.html">
          <span>shared-state</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/soporteremoto.html">
          <span>soporteremoto</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/sprunge.html">
          <span>sprunge</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/ubus-lime-batman-adv.html">
          <span>ubus-lime-batman-adv</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/ubus-lime-groundrouting.html">
          <span>ubus-lime-groundrouting</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/ubus-lime-location.html">
          <span>ubus-lime-location</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/ubus-lime-metrics.html">
          <span>ubus-lime-metrics</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/ubus-lime-openairview.html">
          <span>ubus-lime-openairview</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/ubus-lime-utils.html">
          <span>ubus-lime-utils</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/ubus-tmate.html">
          <span>ubus-tmate</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/watchping.html">
          <span>watchping</span>
        </a>
      </li>
    
      <li class="md-nav__item">
        <a class="md-nav__link" href="/packages/wifi-unstuck-wa.html">
          <span>wifi-unstuck-wa</span>
        </a>
      </li>
    
  </ul>
</li>
          <li class="md-nav__item caption">
    <strong class="text-grey">Links</strong>
</li>
<li class="md-nav__item">
    <a class="md-nav__link" href="https://downloads.libremesh.org/current/">
    <div>
        <i class="fa fa-download" aria-hidden="true"></i>
        <span>Latest Release Firmware</span>
    </div>
    </a>
</li>
<li class="md-nav__item">
    <a class="md-nav__link" href="https://github.com/libremesh/">
    <div>
        <i class="fa fa-code-fork" aria-hidden="true"></i>
        <span>Source Code</span>
    </div>
    </a>
</li>
<li class="md-nav__item">
    <a class="md-nav__link" href="https://www.autistici.org/mailman/listinfo/libremesh">
    <div>
        <i class="fa fa-envelope" aria-hidden="true"></i>
        <span>Mailing List</span>
    </div>
    </a>
</li>
<li class="md-nav__item">
    <a class="md-nav__link" href="https://matrix.to/#/#libremesh-dev:matrix.guifi.net">
    <div>
        <i class="fa fa-comments" aria-hidden="true"></i>
        <span>Element Chatroom</span>
    </div>
    </a>
</li>
      
        </ul>
      </nav>
    </div>
  </div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
  <div class="md-sidebar__scrollwrap">
    <div class="md-sidebar__inner">
      <nav class="md-nav md-nav--secondary">
        <p class="md-nav__title text-grey">Table of contents</p>
        <!-- toc will be appended here!-->
        <ul class="md-nav__list" id="nav_toc"><li class="md-nav__item"><a href="#readme" class="md-nav__link">Readme</a></li><li class="md-nav__item"><a href="#makefile" class="md-nav__link">Makefile</a></li></ul>
        </ul>
      </nav>
    </div>
  </div>
</div>

                <div id="md-container-pancakes">
                <div class="md-content"> 
    <article class="md-content__inner md-typeset">
      <h1 id="lime-curtigghio" style="margin-bottom:0px">lime-curtigghio</h1>
      <a href="https://github.com/libremesh/lime-packages/blob/master/packages/lime-curtigghio">https://github.com/libremesh/lime-packages/blob/master/packages/lime-curtigghio</a>

<div class="packages-container">
<div class="sect1">
<h2 id="readme">Readme</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>= README<br>
:email: <a href="mailto:gio@altermundi.net">gio@altermundi.net</a><br>
:revdate: May 08, 2023<br>
:lang: en</p>
</div>
<div class="paragraph">
<p><strong>TL;DR</strong> Fiddling with <code>hostapd</code> code I have managed to successfully establish WiFi<br>
communication between multiple APs. Each of them sends and receives traffic from<br>
the other as if they were associated <em>stations</em>, even though they are all configured in<br>
AP mode. This P2P-like behavior has multiple advantages compared to the usual<br>
setup where one of them is configured as AP and all the others as stations, and<br>
also compared to Ad-Hoc, WDS, 802.11s, Multi-AP and EasyMesh.<br>
I have named this operating mode APuP (Access Point Micro Peering).</p>
</div>
<div class="paragraph">
<p>== A bit of context</p>
</div>
<div class="paragraph">
<p>In community networks we need to maximize the possible paths of communications<br>
between nodes. In a classical AP-STA approach it is not possible to guarantee<br>
communication between all possible nodes in all scenarios. As an example, we might<br>
have 4 nodes A, B, C and D where A and B see each other, B and C see each<br>
other, and C and D see each other. With AP-STA mode each radio must operate either<br>
as AP or as STA, each STA must connect to only one AP at a time, and a STA needs an AP to<br>
relay communication between them. In each combination, restricting each node<br>
to be an AP or STA you will see that some of them will end up not being able to<br>
connect.</p>
</div>
<div class="paragraph">
<p>To overcome this issue in the past, adhoc mode was used which solved the<br>
basic connectivity issue. However, its implementation wasn't high quality and<br>
its design had important flaws, and it became<br>
unmaintained after a few years. Luckily while adhoc was growing outdated, 802.11s<br>
emerged with a few improvements. Its design choices such as complex<br>
ways to bridge other networks and routing between nodes were fossilized into the<br>
standard. The increased WiFi driver complexity became problematic and ultimately<br>
determined its silent demise. New radios drivers and firmware don't<br>
support 802.11s well. Nor do the WiFi standards bring much improvement to<br>
802.11s mesh mode, while they do improve a lot AP-STA modes. Our need for<br>
nodes to communicate to anyone in range remains strong.</p>
</div>
<div class="paragraph">
<p>With this as background, I started asking myself: is there some hard-to-resolve<br>
problem that impedes AP nodes in sight from talking each other?<br>
Or is there a simple solution?</p>
</div>
<div class="paragraph">
<p>Talking with Felix Fietkau (nbd), we agreed that it might be<br>
possible for AP nodes to communicate directly with each other.<br>
This would be additionally important because AP mode continues to receive<br>
more support and improvements. If there were some slight modification<br>
that allowed APs to talk to other "visible" APs,<br>
we could solve a problem that afflicted us since WiFi creation.<br>
Felix suggested that this should be possible and with a bit of luck should not<br>
even need kernel and driver modifications: modifying <code>hostapd</code> in a way that each<br>
AP adds other visible APs to its station list could be enough. This was indeed<br>
the starting point for my experiments.</p>
</div>
<div class="paragraph">
<p>== Deep diving into hostapd</p>
</div>
<div class="paragraph">
<p>File src/hostapd/drivers/driver.h contain API specification and documentation<br>
of hostapd &#8594; WiFi driver interface.</p>
</div>
<div class="paragraph">
<p>File src/hostapd/drivers/driver_nl80211.c hostapd WiFi driver interface<br>
implementation for nl80211 based wireless devices.</p>
</div>
<div class="paragraph">
<p>=== Adding STA flow</p>
</div>
<div class="paragraph">
<p><code>ap_sta_add(&#8230;&#8203;)</code></p>
</div>
<div class="paragraph">
<p>Relevant functions:<br>
	- <code>wpa_driver_nl80211_sta_add(&#8230;&#8203;)</code></p>
</div>
<div class="paragraph">
<p>File src/hostapd/drivers/driver_nl80211_event.c hostapd receives and handle<br>
events from nl80211 based wireless devices.</p>
</div>
<div class="paragraph">
<p>Relevant functions:<br>
	- <code>do_process_drv_event(&#8230;&#8203;)</code></p>
</div>
<div class="paragraph">
<p>File <code>wpa_supplicant/events.c</code></p>
</div>
<div class="paragraph">
<p>Relevant functions:<br>
	-  <code>wpa_supplicant_event(&#8230;&#8203;)</code></p>
</div>
<div class="paragraph">
<p>Adding STA function flow:</p>
</div>
<div class="paragraph">
<p><code>do_process_drv_event(&#8230;&#8203;) driver_nl80211_event.c &#8594;<br>
`case NL80211_CMD_NEW_STATION:</code> &#8594;<br>
<code>nl80211_new_station_event(&#8230;&#8203;)</code> &#8594;<br>
<code>drv_event_assoc(&#8230;&#8203;)</code> driver.h &#8594;<br>
<code>wpa_supplicant_event(&#8230;&#8203;, EVENT_ASSOC, &#8230;&#8203;)</code> wpa_supplicant/events.c  &#8594;<br>
<code>case EVENT_ASSOC:</code> &#8594;<br>
<code>wpa_supplicant_event_assoc(..) &amp;&amp; wpa_supplicant_event_assoc_auth(&#8230;&#8203;)</code></p>
</div>
<div class="paragraph">
<p><code>wpa_supplicant_event_assoc(..)</code> &#8594;<br>
<code>hostapd_notif_assoc(&#8230;&#8203;)</code> drv_callbacks.c &#8594;<br>
<code>ap_sta_add(&#8230;&#8203;) ; hostapd_sta_assoc(&#8230;&#8203;)</code> &#8594;</p>
</div>
<div class="paragraph">
<p><code>ap_sta_add(&#8230;&#8203;)</code> stainfo.c the new station is finally added to the list of<br>
associated station to this AP in hostapd</p>
</div>
<div class="paragraph">
<p><code>hostapd_sta_assoc(&#8230;&#8203;)</code> &#8594; <code>driver&#8594;sta_assoc(&#8230;&#8203;)</code> driver.h<br>
driver_nl80211.c does nothing for nl80211 devices</p>
</div>
<div class="paragraph">
<p><code>wpa_supplicant_event_assoc_auth(&#8230;&#8203;)</code> wpa_supplicant/events.c seems to deal<br>
with WPA authentication specific stuff</p>
</div>
<div class="paragraph">
<p>=== Adding WDS station flow</p>
</div>
<div class="paragraph">
<p>Relevant functions:<br>
 - <code>wpa_driver_ops&#8594;set_wds_sta(&#8230;&#8203;)</code> file src/drivers/driver.h pointer to<br>
	hostapd<br>
	driver specific function to add or remove WDS stations, along with some<br>
	documentation about it<br>
 - <code>hostapd_set_wds_sta(&#8230;&#8203;)</code> file src/ap/ap_drv_ops.c do a few checks and<br>
	operations about bridging configuration then call<br>
	<code>hapd&#8594;driver&#8594;set_wds_sta(&#8230;&#8203;)</code> aka <code>i802_set_wds_sta(&#8230;&#8203;)</code><br>
 - <code>i802_set_wds_sta(&#8230;&#8203;)</code> file src/hostapd/drivers/driver_nl80211.c<br>
	implementation of <code>wpa_driver_ops&#8594;set_wds_sta(&#8230;&#8203;)</code> for mac80211 driver</p>
</div>
<div class="paragraph">
<p>When an AP receive an association request <code>handle_assoc_cb(&#8230;&#8203;)</code> file<br>
src/ap/ieee802_11.c is called if <code>WLAN_STA_WDS</code> flag is set then<br>
<code>hostapd_set_wds_sta(&#8230;&#8203;)</code> is called</p>
</div>
<div class="paragraph">
<p>=== Other APs beacon handling flow</p>
</div>
<div class="listingblock">
<div class="content">
<pre> * @NL80211_CMD_REGISTER_BEACONS: Register this socket to receive beacons from
 *	other BSSes when any interfaces are in AP mode. This helps implement
 *	OLBC handling in hostapd. Beacons are reported in %NL80211_CMD_FRAME
 *	messages. Note that per PHY only one application may register.</pre>
</div>
</div>
<div class="paragraph">
<p><code>nl80211_register_beacons(&#8230;&#8203;)</code> driver_nl80211.c register hostapd to<br>
receive events from the kernel when beacons from other BSS are received, inside<br>
this function no specific callback is passed to the kernel.<br>
Inside <code>nl80211_get_wiphy_data_ap(&#8230;&#8203;)</code> driver_nl80211.c I have found the only<br>
usage of the former function, <code>process_beacon_event(&#8230;&#8203;)</code> driver_nl80211.c is<br>
registered as<br>
callback and then <code>nl80211_register_beacons(&#8230;&#8203;)</code> is finally called if<br>
everything goes fine another function<br>
<code>nl80211_recv_beacons(&#8230;&#8203;)</code> driver_nl80211.c is register with a call to<br>
<code>nl80211_register_eloop_read(&#8230;&#8203;)</code> driver_nl80211.c .</p>
</div>
<div class="paragraph">
<p><code>nl80211_recv_beacons(&#8230;&#8203;)</code> driver_nl80211.c which just call the more obscure<br>
<code>nl_recvmsgs(handle, w&#8594;nl_cb);</code> where <code>w&#8594;nl_cb</code> seems to be<br>
<code>process_beacon_event(&#8230;&#8203;)</code> again&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p><code>process_beacon_event(&#8230;&#8203;)</code> driver_nl80211.c do a few checks and then forward<br>
the event to <code>wpa_supplicant_event(drv&#8594;ctx, EVENT_RX_MGMT, &amp;event);</code> which if<br>
the beacon was received on an AP interface just call<br>
<code>ap_mgmt_rx(wpa_s, &amp;data&#8594;rx_mgmt);</code> at line 5598 of wpa_supplicant/events.c.</p>
</div>
<div class="paragraph">
<p><code>ap_mgmt_rx(&#8230;&#8203;)</code> wpa_supplicant/ap.c just call<br>
<code>ieee802_11_mgmt(&#8230;&#8203;)</code> src/ap/iee802_11.c which at line 6337 calls<br>
<code>handle_beacon(&#8230;&#8203;);</code> src/ap/iee802_11.c which do a few checks and then calls<br>
<code>ap_list_process_beacon(&#8230;&#8203;)</code> src/ap/ap_list.c which finally seems to add the<br>
AP from where the beacon originated to the list of known APs and do a few more<br>
checks about <em>overlapping legacy BSS condition</em>.</p>
</div>
<div class="paragraph">
<p>== OpenWrt hostapd packaging</p>
</div>
<div class="paragraph">
<p><code>hostapd</code> openwrt package is shipped together with OpenWrt sources, and it is<br>
found at package/network/services/hostapd/. In this directory we find<br>
<code>README.md</code> file which show a few interesting methods of the hostapd ubus<br>
interface and <code>Makefile</code> where all the <code>hostapd</code> OpenWrt variants like <code>wpad</code><br>
are defined. The <code>Makefile</code> is complex because there are many variants<br>
depending on which subset of <code>hostapd</code> features are enabled, on what SSL/TLS<br>
library is used, etc. The <code>Makefile</code> is structured to avoid duplicating code and<br>
common options all around that effectively reduces the size of the <code>Makefile</code><br>
and probably ease the work for the maintainer.</p>
</div>
<div class="paragraph">
<p>Depending on package variant OpenWrt <code>hostapd</code> package <code>Makefile</code> sets multiple<br>
configs with statements like <code>DRIVER_MAKEOPTS += CONFIG_AP=y</code> or<br>
<code>DRIVER_MAKEOPTS += CONFIG_TLS=openssl CONFIG_SAE=y</code>. Those configurations<br>
don&#8217;t seem to impact directly in the hostapd C code <code>#ifdef</code> but are handled<br>
within <code>hostapd</code> and <code>wpa_supplicant</code> sources <code>Makefile</code> which depend on the<br>
passed configs to set the proper <code>CFLAGS</code>, C source files and output objects files.</p>
</div>
<div class="paragraph">
<p>To use our customized <code>hostapd</code> source in OpenWrt we use source tree override<br>
<a href="https://forum.archive.openwrt.org/viewtopic.php?id=46916">as explained by Jow</a></p>
</div>
<div class="paragraph">
<p>Plus a couple more steps to integrate OpenWrt <code>hostapd</code> specific patches and<br>
additional sources.</p>
</div>
<div class="paragraph">
<p><code>rsync -aPh ~/Builds/openwrt/package/network/services/hostapd/src/ ./</code><br>
<code>for mPatch in ~/Builds/openwrt/package/network/services/hostapd/patches/*.patch  ; do patch -p1 &lt; $mPatch ; done</code></p>
</div>
<div class="paragraph">
<p>The modified <code>hostapd</code> code I published on my<br>
<a href="https://gitlab.com/g10h4ck/hostap/-/tree/APuP">gitlab sandbox</a> already<br>
includes those so you don&#8217;t need to reapply them.</p>
</div>
<div class="paragraph">
<p>To clean and re-build only hostapd package use<br>
<code>make package/network/services/hostapd/clean</code><br>
<code>make package/network/services/hostapd/compile</code></p>
</div>
<div class="paragraph">
<p>== hostapd modifications</p>
</div>
<div class="paragraph">
<p>To enable WDS AP - AP I have modified <code>handle_beacon(&#8230;&#8203;)</code> function defined in<br>
src/ap/ieee802_11.c, so when a beacon from another AP is received, <code>hostapd</code> also<br>
checks if the advertised SSID is the same as one advertised<br>
by current instance. If so, information from that beacon is extracted and<br>
adapted to look like station information, and a station entry is populated<br>
into the hostapd station list. <em>These modifications should be put into their own<br>
function later.</em></p>
</div>
<div class="paragraph">
<p>To avoid loops from all specific interfaces created for each AP-AP connection<br>
being bridged automatically by <code>hostapd</code>, I have temporarily<br>
disabled bridging in <code>hostapd_set_wds_sta</code> defined in src/ap/ap_drv_ops.c.<br>
<em>This should become a runtime configuration later.</em></p>
</div>
<div class="paragraph">
<p>I have also added a compile time config <code>CONFIG_APUP</code> in hostapd/Makefile so<br>
these modifications can be easly enabled at compile time.</p>
</div>
<div class="paragraph">
<p>I have tested the modifications and after a round of trial and error, it<br>
works as expected with good performance. You can see the <code>test.sh</code> script<br>
which configures four vanilla OpenWrt routers into a working testbed to see how<br>
to use this.</p>
</div>
<div class="paragraph">
<p>The modified <code>hostapd</code> code is published on my<br>
<a href="https://gitlab.com/g10h4ck/hostap/-/tree/APuP">gitlab sandbox</a></p>
</div>
<div class="paragraph">
<p>== Useful snippets</p>
</div>
<div class="listingblock">
<div class="title">Log: TL-WDR3600 and TL-WDR4300 WDS AP - AP connection success</div>
<div class="content">
<pre>Fri Apr 28 22:24:11 2023 daemon.notice hostapd: Configuration file: /var/run/hostapd-phy1.conf (phy phy1-ap0) --&gt; new PHY
Fri Apr 28 22:24:11 2023 daemon.notice netifd: wan (1619): udhcpc: broadcasting discover
Fri Apr 28 22:24:12 2023 kern.info kernel: [   39.574041] IPv6: ADDRCONF(NETDEV_CHANGE): phy1-ap0: link becomes ready
Fri Apr 28 22:24:12 2023 daemon.notice hostapd: phy1-ap0: interface state UNINITIALIZED-&gt;ENABLED
Fri Apr 28 22:24:12 2023 daemon.notice hostapd: phy1-ap0: AP-ENABLED
Fri Apr 28 22:24:12 2023 daemon.notice hostapd: Configuration file: /var/run/hostapd-phy0.conf (phy phy0-ap0) --&gt; new PHY
Fri Apr 28 22:24:12 2023 kern.info kernel: [   39.827175] IPv6: ADDRCONF(NETDEV_CHANGE): phy0-ap0: link becomes ready
Fri Apr 28 22:24:12 2023 daemon.notice hostapd: phy0-ap0: interface state UNINITIALIZED-&gt;ENABLED
Fri Apr 28 22:24:12 2023 daemon.notice hostapd: phy0-ap0: AP-ENABLED
Fri Apr 28 22:24:12 2023 daemon.notice hostapd: phy1-ap0: AP-STA-CONNECTED 64:70:02:de:c5:1e auth_alg=open
Fri Apr 28 22:24:12 2023 daemon.notice hostapd: phy1-ap0: WDS-STA-INTERFACE-ADDED ifname=phy1-ap0.sta1 sta_addr=64:70:02:de:c5:1e
Fri Apr 28 22:24:12 2023 daemon.notice hostapd: handle_beacon(...) Added WDS AP at phy1-ap0.sta1 with flags: 35491, capabilities 33
Fri Apr 28 22:24:12 2023 daemon.notice hostapd: phy0-ap0: AP-STA-CONNECTED 64:70:02:de:c5:1d auth_alg=open
Fri Apr 28 22:24:12 2023 daemon.notice hostapd: phy0-ap0: WDS-STA-INTERFACE-ADDED ifname=phy0-ap0.sta1 sta_addr=64:70:02:de:c5:1d
Fri Apr 28 22:24:12 2023 daemon.notice hostapd: handle_beacon(...) Added WDS AP at phy0-ap0.sta1 with flags: 35491, capabilities 1057</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Log: Two DAP-X1860-A1 WDS AP - AP connection success</div>
<div class="content">
<pre>Thu May 25 21:55:04 2023 daemon.notice hostapd: phy0-ap0: AP-STA-CONNECTED a8:63:7d:2e:97:d9 auth_alg=open
Thu May 25 21:55:05 2023 daemon.notice hostapd: phy0-ap0: WDS-STA-INTERFACE-ADDED ifname=phy0-ap0.sta1 sta_addr=a8:63:7d:2e:97:d9
Thu May 25 21:55:05 2023 daemon.notice netifd: Interface 'curtigghio' is now down
Thu May 25 21:55:05 2023 daemon.notice hostapd: handle_beacon(...) Added WDS AP at phy0-ap0.sta1 with flags: 35491, capabilities 1057
Thu May 25 21:55:05 2023 daemon.notice netifd: Interface 'curtigghio' is setting up now
Thu May 25 21:55:05 2023 daemon.notice netifd: Interface 'curtigghio' is now up
Thu May 25 21:55:05 2023 daemon.notice netifd: Network device 'phy0-ap0.sta1' link is up
Thu May 25 21:55:05 2023 daemon.notice hostapd: phy1-ap0: AP-STA-CONNECTED a8:63:7d:2e:97:dc auth_alg=open
Thu May 25 21:55:05 2023 daemon.notice hostapd: phy1-ap0: WDS-STA-INTERFACE-ADDED ifname=phy1-ap0.sta1 sta_addr=a8:63:7d:2e:97:dc
Thu May 25 21:55:05 2023 daemon.notice hostapd: handle_beacon(...) Added WDS AP at phy1-ap0.sta1 with flags: 297635, capabilities 33
Thu May 25 21:55:05 2023 daemon.notice netifd: Network device 'phy1-ap0.sta1' link is up</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Log: plain station connecting and desconnecting to the AP</div>
<div class="content">
<pre>Sun Jan  1 22:06:54 2023 daemon.notice hostapd: phy0-ap0: interface state UNINITIALIZED-&gt;ENABLED
Sun Jan  1 22:06:54 2023 daemon.notice hostapd: phy0-ap0: AP-ENABLED
Sun Jan  1 22:06:54 2023 daemon.notice hostapd: LIME_CURTIJJO nl80211: Drv Event 60 (NL80211_CMD_FRAME_TX_STATUS) received for phy0-ap0
Sun Jan  1 22:07:09 2023 daemon.notice hostapd: LIME_CURTIJJO nl80211: Drv Event 60 (NL80211_CMD_FRAME_TX_STATUS) received for phy0-ap0
Sun Jan  1 22:07:09 2023 daemon.notice hostapd: LIME_CURTIJJO ap_sta_add addr: b4:9d:0b:87:ed:06
Sun Jan  1 22:07:09 2023 daemon.notice hostapd: LIME_CURTIJJO ap_sta_add addr: b4:9d:0b:87:ed:06 New STA
Sun Jan  1 22:07:09 2023 daemon.notice hostapd: LIME_CURTIJJO hostapd_sta_add explicit params addr=b4:9d:0b:87:ed:06 aid=0 capability=0 supp_rates=0x77aee688 supp_rates_len=3 listen_interval=0 ht_capab=0 vht_capab=0 he_capab=0 he_capab_len=0 eht_capab=0 eht_capab_len=0 he_6ghz_capab=0 flags=0 qosinfo=0 vht_opmode=0 supp_p2p_ps=0 set=0
Sun Jan  1 22:07:09 2023 daemon.debug hostapd: phy0-ap0: STA b4:9d:0b:87:ed:06 IEEE 802.11: authentication OK (open system)
Sun Jan  1 22:07:09 2023 daemon.debug hostapd: phy0-ap0: STA b4:9d:0b:87:ed:06 MLME: MLME-AUTHENTICATE.indication(b4:9d:0b:87:ed:06, OPEN_SYSTEM)
Sun Jan  1 22:07:09 2023 daemon.debug hostapd: phy0-ap0: STA b4:9d:0b:87:ed:06 MLME: MLME-DELETEKEYS.request(b4:9d:0b:87:ed:06)
Sun Jan  1 22:07:09 2023 daemon.notice hostapd: LIME_CURTIJJO nl80211: Drv Event 19 (NL80211_CMD_NEW_STATION) received for phy0-ap0
Sun Jan  1 22:07:09 2023 daemon.notice hostapd: LIME_CURTIJJO nl80211: Drv Event 60 (NL80211_CMD_FRAME_TX_STATUS) received for phy0-ap0
Sun Jan  1 22:07:09 2023 daemon.info hostapd: phy0-ap0: STA b4:9d:0b:87:ed:06 IEEE 802.11: authenticated
Sun Jan  1 22:07:09 2023 daemon.debug hostapd: phy0-ap0: STA b4:9d:0b:87:ed:06 IEEE 802.11: association OK (aid 1)
Sun Jan  1 22:07:09 2023 daemon.notice hostapd: LIME_CURTIJJO hostapd_sta_add explicit params addr=b4:9d:0b:87:ed:06 aid=1 capability=1057 supp_rates=0x77aee688 supp_rates_len=8 listen_interval=1 ht_capab=0x7f7aec04 vht_capab=0 he_capab=0 he_capab_len=0 eht_capab=0 eht_capab_len=0 he_6ghz_capab=0 flags=35459 qosinfo=0 vht_opmode=0 supp_p2p_ps=0 set=1
Sun Jan  1 22:07:09 2023 daemon.notice hostapd: LIME_CURTIJJO nl80211: Drv Event 60 (NL80211_CMD_FRAME_TX_STATUS) received for phy0-ap0
Sun Jan  1 22:07:09 2023 daemon.info hostapd: phy0-ap0: STA b4:9d:0b:87:ed:06 IEEE 802.11: associated (aid 1)
Sun Jan  1 22:07:09 2023 daemon.notice hostapd: phy0-ap0: AP-STA-CONNECTED b4:9d:0b:87:ed:06 auth_alg=open
Sun Jan  1 22:07:09 2023 daemon.debug hostapd: phy0-ap0: STA b4:9d:0b:87:ed:06 MLME: MLME-ASSOCIATE.indication(b4:9d:0b:87:ed:06)
Sun Jan  1 22:07:09 2023 daemon.debug hostapd: phy0-ap0: STA b4:9d:0b:87:ed:06 MLME: MLME-DELETEKEYS.request(b4:9d:0b:87:ed:06)
Sun Jan  1 22:07:09 2023 daemon.debug hostapd: phy0-ap0: STA b4:9d:0b:87:ed:06 IEEE 802.11: binding station to interface 'phy0-ap0'
Sun Jan  1 22:07:12 2023 daemon.info dnsmasq-dhcp[1]: DHCPDISCOVER(br-lan) b4:9d:0b:87:ed:06
Sun Jan  1 22:07:12 2023 daemon.info dnsmasq-dhcp[1]: DHCPOFFER(br-lan) 192.168.1.122 b4:9d:0b:87:ed:06
Sun Jan  1 22:07:12 2023 daemon.info dnsmasq-dhcp[1]: DHCPREQUEST(br-lan) 192.168.1.122 b4:9d:0b:87:ed:06
Sun Jan  1 22:07:12 2023 daemon.info dnsmasq-dhcp[1]: DHCPNAK(br-lan) 192.168.1.122 b4:9d:0b:87:ed:06 wrong server-ID
Sun Jan  1 22:07:28 2023 daemon.notice hostapd: phy0-ap0: AP-STA-DISCONNECTED b4:9d:0b:87:ed:06
Sun Jan  1 22:07:28 2023 daemon.debug hostapd: phy0-ap0: STA b4:9d:0b:87:ed:06 IEEE 802.11: deauthenticated
Sun Jan  1 22:07:28 2023 daemon.debug hostapd: phy0-ap0: STA b4:9d:0b:87:ed:06 MLME: MLME-DEAUTHENTICATE.indication(b4:9d:0b:87:ed:06, 3)
Sun Jan  1 22:07:28 2023 daemon.debug hostapd: phy0-ap0: STA b4:9d:0b:87:ed:06 MLME: MLME-DELETEKEYS.request(b4:9d:0b:87:ed:06)
Sun Jan  1 22:07:28 2023 daemon.notice hostapd: LIME_CURTIJJO nl80211: Drv Event 20 (NL80211_CMD_DEL_STATION) received for phy0-ap0</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Dump ieee802_11_elems</div>
<div class="content">
<pre>	wpa_printf( MSG_INFO,
	            "handle_beacon(...) elems: "
	            "ssid %.*s "
	            "supp_rates_len %d, "
	            "ds_params %p, "
	            "challenge_len %d, "
	            "erp_info %p, "
	            "ext_supp_rates_len %d, "
	            "wpa_ie_len %d, "
	            "rsn_ie_len %d, "
	            "rsnxe_len %d, "
	            "wmm_len %d, "
	            "wmm_tspec_len %d, "
	            "wps_ie_len %d, "
	            "supp_channels_len %d, "
	            "mdie_len %d, "
	            "ftie_len %d, "
	            "timeout_int %p, "
	            "ht_capabilities %p, "
	            "ht_operation %p, "
	            "mesh_config_len %d, "
	            "mesh_id_len %d, "
	            "peer_mgmt_len %d, "
	            "vht_capabilities %p, "
	            "vht_operation %p, "
	            "vht_opmode_notif %p, "
	            "vendor_ht_cap_len %d, "
	            "vendor_vht_len %d, "
	            "p2p_len %d, "
	            "wfd_len %d, "
	            "link_id %p, "
	            "interworking_len %d, "
	            "qos_map_set_len %d, "
	            "hs20_len %d, "
	            "bss_max_idle_period %p, "
	            "ext_capab_len %d, "
	            "ssid_list_len %d, "
	            "osen_len %d, "
	            "mbo_len %d, "
	            "ampe_len %d, "
	            "mic_len %d, "
	            "pref_freq_list_len %d, "
	            "supp_op_classes_len %d, "
	            "rrm_enabled_len %d, "
	            "cag_number_len %d, "
	            "ap_csn %p, "
	            "fils_indic_len %d, "
	            "dils_len %d, "
	            "assoc_delay_info %p,"
	            "fils_req_params_len %d, "
	            "fils_key_confirm_len %d, "
	            "fils_session %p, "
	            "fils_hlp_len %d, "
	            "fils_ip_addr_assign_len %d, "
	            "key_delivery_len %d, "
	            "wrapped_data_len %d, "
	            "fils_pk_len %d, "
	            "fils_nonce %p, "
	            "owe_dh_len %d, "
	            "power_capab_len %d, "
	            "roaming_cons_sel_len %d, "
	            "password_id_len %d, "
	            "oci_len %d, "
	            "multi_ap_len %d, "
	            "he_capabilities_len %d, "
	            "he_operation_len %d, "
	            "short_ssid_list_len %d, "
	            "he_6ghz_band_cap %p,"
	            "sae_pk_len %d, "
	            "s1g_capab %p, "
	            "pasn_params_len %d, "
	            "eht_capabilities_len %d, "
	            "eht_operation_len %d, "
	            "basic_mle_len %d, "
	            "probe_req_mle_len %d, "
	            "reconf_mle_len %d, "
	            "tdls_mle_len %d, "
	            "prior_access_mle_len %d, "
	            "mbssid_known_bss_len %d |END|"
	            ,
	            (int) elems.ssid_len, elems.ssid,
	            elems.supp_rates_len,
	            elems.ds_params,
	            elems.challenge_len,
	            elems.erp_info,
	            elems.ext_supp_rates_len,
	            elems.wpa_ie_len,
	            elems.rsn_ie_len,
	            elems.rsnxe_len,
	            elems.wmm_len,
	            elems.wmm_tspec_len,
	            elems.wps_ie_len,
	            elems.supp_channels_len,
	            elems.mdie_len,
	            elems.ftie_len,
	            elems.timeout_int,
	            elems.ht_capabilities,
	            elems.ht_operation,
	            elems.mesh_config_len,
	            elems.mesh_id_len,
	            elems.peer_mgmt_len,
	            elems.vht_capabilities,
	            elems.vht_operation,
	            elems.vht_opmode_notif,
	            elems.vendor_ht_cap_len,
	            elems.vendor_vht_len,
	            elems.p2p_len,
	            elems.wfd_len,
	            elems.link_id,
	            elems.interworking_len,
	            elems.qos_map_set_len,
	            elems.hs20_len,
	            elems.bss_max_idle_period,
	            elems.ext_capab_len,
	            elems.ssid_list_len,
	            elems.osen_len,
	            elems.mbo_len,
	            elems.ampe_len,
	            elems.mic_len,
	            elems.pref_freq_list_len,
	            elems.supp_op_classes_len,
	            elems.rrm_enabled_len,
	            elems.cag_number_len,
	            elems.ap_csn,
	            elems.fils_indic_len,
	            elems.dils_len,
	            elems.assoc_delay_info,
	            elems.fils_req_params_len,
	            elems.fils_key_confirm_len,
	            elems.fils_session,
	            elems.fils_hlp_len,
	            elems.fils_ip_addr_assign_len,
	            elems.key_delivery_len,
	            elems.wrapped_data_len,
	            elems.fils_pk_len,
	            elems.fils_nonce,
	            elems.owe_dh_len,
	            elems.power_capab_len,
	            elems.roaming_cons_sel_len,
	            elems.password_id_len,
	            elems.oci_len,
	            elems.multi_ap_len,
	            elems.he_capabilities_len,
	            elems.he_operation_len,
	            elems.short_ssid_list_len,
	            elems.he_6ghz_band_cap,
	            elems.sae_pk_len,
	            elems.s1g_capab,
	            elems.pasn_params_len,
	            elems.eht_capabilities_len,
	            elems.eht_operation_len,
	            elems.basic_mle_len,
	            elems.probe_req_mle_len,
	            elems.reconf_mle_len,
	            elems.tdls_mle_len,
	            elems.prior_access_mle_len,
	            elems.mbssid_known_bss_len
	            );</pre>
</div>
</div>
<div class="paragraph">
<p><a href="http://www.bradgoodman.com/bittool/" class="bare">http://www.bradgoodman.com/bittool/</a></p>
</div>
<div class="paragraph">
<p>== WDS Station interface bridging</p>
</div>
<div class="paragraph">
<p><code>hostapd</code> adds WDS STA interfaces to a bridge either the same of plain station<br>
passed with the <code>bridge</code> option or to another one passed with the <code>wds_bridge</code>.<br>
In our use case this is not ideal as we might want to give routing protocols access<br>
directly to the station interface. Moreover in a mesh setup, multiple links could<br>
easily cause a bridge loop: linux simple bridge will not avoid this<br>
as is. To disable automatic bridging set <code>wds_bridge</code> to an empty string in the<br>
<code>hostapd</code> config file.</p>
</div>
<div class="paragraph">
<p>== Interesting conversations</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[16:11] &lt;dwfreed&gt; G10h4ck: ovsdb is what actually contains the switch configuration; it's needed
[16:13] &lt;-- Guest2984 (~srslypasc@0002bff5.user.oftc.net) has left this server (Ping timeout: 480 seconds).
[16:19] &lt;-- Borromini (~Jean-Jacq@0001344c.user.oftc.net) has left this server (Quit: Lost terminal).
[16:27] &lt;-- cbeznea (~claudiu@82.78.167.116) has left this server (Quit: Leaving.).
[16:41] &lt;-- borek (~Thunderbi@2001:1488:fffe:6:e258:8d45:f844:67) has left this server (Ping timeout: 480 seconds).
[17:11] &lt;G10h4ck&gt; dwfreed in my case the heig level configuration is managed by another custom compontent which is able to output openflow
[17:11] --&gt; csrf1 (~csrf@ip72-199-118-215.sd.sd.cox.net) has joined this channel.
[17:12] &lt;G10h4ck&gt; in that case I guess only only ovs-vswitchd should be needed
[17:13] &lt;G10h4ck&gt; anyway I see  libopenvswitch is 2.3M it seems huge for an embedded device, and used by even the most basic tool ovs-ctl -_-  is this the toll to use openvswitch ?
[17:14] &lt;-- csrf1 (~csrf@ip72-199-118-215.sd.sd.cox.net) has left this server.
[17:14] --&gt; csrf (~csrf@ip72-199-118-215.sd.sd.cox.net) has joined this channel.
[17:19] &lt;dwfreed&gt; I mean, yeah
[17:20] &lt;dwfreed&gt; ovs is not intended for microscopic devices
[17:21] &lt;dwfreed&gt; equally I would not expect non-trivial configs to work well with the barebones DSA implementations of embedded devices
[17:22] &lt;G10h4ck&gt; dwfreed the idea is to use openvswitch mainly as datapath, another component which understand mesh networks would configure it
[17:22] &lt;-- csrf (~csrf@ip72-199-118-215.sd.sd.cox.net) has left this server (Remote host closed the connection).
[17:22] &lt;G10h4ck&gt; sadly batman-adv seems not much alive anymore so we are looking for alternatives way
[17:22] --&gt; csrf (~csrf@ip72-199-118-215.sd.sd.cox.net) has joined this channel.
[17:23] &lt;G10h4ck&gt; the idea we had was "let's implement layed 2 mesh logic in userspace and then configure openvswitch as kernel space datapath"
[17:23] &lt;G10h4ck&gt; and we are investigating the fesibility
[17:24] &lt;G10h4ck&gt; so basically we would have an ovs bridge with ethernet ports and wifi mesh ports, and then the table of the switch would be manipulated by a mesh aware compontent, to deal with loops, lossy links etc..
[17:25] &lt;nbd&gt; if you're doing your own datapath thing anyway, why not just implement the datapath in ebpf?
[17:29] &lt;G10h4ck&gt; I have thinked of that too nbd to use openvswitch was to avoid implementing the datapath, and just implement the mesh logic
[17:29] &lt;G10h4ck&gt; nbd did you recognized me? it's Gio from libre-mesh
[17:29] &lt;nbd&gt; yes
[17:29] &lt;nbd&gt; it's been a while
[17:30] &lt;G10h4ck&gt; how ar ere you?
[17:31] &lt;nbd&gt; doing fine, thanks. how about you?
[17:31] &lt;G10h4ck&gt; I am good too, in Argentina right now with the Altermundi people
[17:31] &lt;nbd&gt; cool
[17:31] &lt;G10h4ck&gt; so I thinked that openvswitch datapath should be fine for libre-mesh setup, but was just exploring that
[17:32] &lt;G10h4ck&gt; do you think reimplementing the datapath in ebpf would endup working better then attempting to reuse openvswitch stuff?
[17:32] &lt;nbd&gt; depends on the needs of the routing algorithm, i guess
[17:32] &lt;nbd&gt; with ebpf you can have more control over the datapath
[17:33] &lt;G10h4ck&gt; my idea was to keep the datapath kernel-space and move the wole mesh login like link discovery. quality measure, calculatinc best path etc. in user space
[17:33] &lt;nbd&gt; but it takes a while to learn how to fight the verifier :)
[17:33] &lt;nbd&gt; that makes sense
[17:34] &lt;nbd&gt; either way, if you choose ovs, i would recommend simply not using any of the existing ovs user space code
[17:35] &lt;nbd&gt; and just write your own thing that talks to the kernel ovs api
[17:35] &lt;nbd&gt; i don't think there's any easy way to cut down on the amount of bloat in the ovs user space
[17:36] &lt;G10h4ck&gt; it is a pity the ovs userspace is so bloated...
[17:37] &lt;G10h4ck&gt; thanks nbd i was feeling a bit lost exploring all that stuff and your opinion helps a lot
[17:38] &lt;nbd&gt; i think a ebpf data path in the kernel might actually end up being rather simple
[17:39] &lt;nbd&gt; the routing table is basically a map that uses the destination mac as primary key
[17:39] &lt;nbd&gt; and points to an entry in another map that keeps track of links
[17:39] &lt;nbd&gt; containing metadata such as the output device, packet counters, etc.
[17:40] &lt;nbd&gt; the program should recognize protocol data packets and simply bounce them to user space on a separate device
[17:41] &lt;nbd&gt; if you're using a custom eth type for encapsulation and don't use IP, the header overhead should be small as well
[17:41] &lt;nbd&gt; initially i would recommend simply bouncing all multicast traffic into user space and forwarding it from there
[17:42] &lt;nbd&gt; multicast/broadcast
[17:42] &lt;nbd&gt; makes it easier to deal with special cases for dhcp, arp, etc.
[17:43] &lt;G10h4ck&gt; thanks!
[17:43] &lt;nbd&gt; you're welcome. let me know how it goes and which approach you decide on
[17:43] &lt;nbd&gt; i'm definitely interested in this
[17:44] &lt;nbd&gt; i also have some experience writing ebpf programs, so i can offer some advice if you get stuck somewhere
[17:44] &lt;G10h4ck&gt; great!
[17:45] &lt;nbd&gt; for openwrt, i wrote 'bridger', which is a fast path for the linux bridge code and 'qosify' which does rule based dscp marking
[17:45] &lt;G10h4ck&gt; in current openwrt compiling ebpf stuff is already integrated in the toolchain?
[17:46] &lt;nbd&gt; there's some makefile magic to make it easy to build and package ebpf code
[17:46] &lt;G10h4ck&gt; didn't know of those new components at all!
[17:47] &lt;nbd&gt; inside qosify or unetd you can also find a header file bpf_skb_utils.h which makes it much easier to parse ip protocol stuff in skbs
[17:47] &lt;G10h4ck&gt; qosify seems something we my end up using in libre-mesh
[17:47] &lt;nbd&gt; maybe you might be interested in unetd as well
[17:48] &lt;nbd&gt; my goal with it was to create the easiest way to deploy and manage fully meshed decentralized wireguard networks
[17:48] &lt;G10h4ck&gt; very interesting
[17:49] &lt;nbd&gt; it also makes it easy to layer vxlan on top to bridge l2 segments over the network
[17:50] &lt;G10h4ck&gt; it seemsto have many interesting overlapping area which what i was investigating :D
[17:50] &lt;nbd&gt; https://openwrt.org/docs/techref/unetd
[17:50] &lt;nbd&gt; :)
[17:51] &lt;nbd&gt; unetd can also do direct connections over double-NAT, assuming at least one node is publicly reachable (or you're using DHT + a STUN server)
[17:52] &lt;G10h4ck&gt; and what happens if some connections are over lossy wifi links ? (smirk smirk)
[17:53] &lt;nbd&gt; it doesn't do any form of mesh routing
[17:53] &lt;nbd&gt; though i guess that might be interesting too
[17:54] &lt;nbd&gt; it has some limited configuration where you configure a node as a gateway for another node
[17:55] &lt;nbd&gt; it works on the basis of having a cryptographically signed network topology with wireguard keys, hostnames and ip/subnet addresses reachable over nodes with those keys
[17:56] &lt;nbd&gt; you can update the network topology and it'll spread across participating nodes
[17:56] --&gt; minimal (~minimal@0002b71e.user.oftc.net) has joined this channel.
[17:56] &lt;nbd&gt; and it'll exchange peer endpoint information to try to get every node to be able to talk to all other nodes directly
[17:58] &lt;nbd&gt; anyways... it was good talking to you, i need to get some sleep now
[17:58] &lt;nbd&gt; the kids wake me up early in the morning
[17:58] &lt;G10h4ck&gt; have a good sleep
[17:58] &lt;nbd&gt; thanks
[17:58] &lt;G10h4ck&gt; hugs to the family
[17:58] &lt;G10h4ck&gt; and thanks for sharing all the interesting ideas

[11:24] &lt;G10h4ck&gt; hi all!
[11:24] --&gt; Gaspare (~Gaspare@177-38-99-106.netway.psi.br) has joined this channel.
[11:25] &lt;G10h4ck&gt; nbd I was diving into eBPF and found that linux have many helper functions like bpf_skb_vlan_push, i was wandering if it is powwible to manipulate wifi frames with similar helpers, in particular if there is a way to access and manypulate the 4 macaddress fields in the wifi data frames
[11:29] &lt;nbd&gt; you can insert headers, manipulate frame data, etc.
[11:29] &lt;nbd&gt; it's quite flexible
[11:31] &lt;G10h4ck&gt; I was wondering about forwarding L2 frames without need to encapsulate them, encapsulating L2 stuff have gine MTU quirks historically expecially when both cabled ethernet and wifi links are involved
[11:31] &lt;G10h4ck&gt; we managed to work around those hickups, but prevent them radically is tempting
[11:32] &lt;G10h4ck&gt; so if we can access the four macs fields in the wifi frame we gould use one for real source and one for real destination
[11:32] &lt;-- Gaspare (~Gaspare@177-38-99-106.netway.psi.br) has left this server (Ping timeout: 480 seconds).
[11:34] &lt;nbd&gt; G10h4ck: in unetd vxlan i had mtu issues as well, so i wrote a BPF program that fixes the TCP MSS option to deal with that
[11:34] &lt;G10h4ck&gt; yeah we have that sort of workaround in place in libremesh too
[11:34] &lt;G10h4ck&gt; but they always fix only part of the problem
[11:35] &lt;G10h4ck&gt; at some point we endup having reports from users the the app X that uses it's own UDP based transport protocol doesn't work as expected for example
[11:36] &lt;G10h4ck&gt; in the end we have all user facing network interfaces setted with MTU 1350
[11:36] &lt;G10h4ck&gt; we also telle the clients via DHCP that the mtu is 1350 and so on
[11:36] &lt;G10h4ck&gt; but there is always some quirks
[11:37] &lt;nbd&gt; you could bounce oversized packets to user space and let user space send back ICMP error packets to trigger path MTU discovery
[11:37] &lt;G10h4ck&gt; in our case it seems we can avoid it almost completely in most of the case by avoiding encapsulation unless it is strictly needed
[11:38] &lt;G10h4ck&gt; on cabled links we could just forward the frame as-is to the correct interface
[11:38] &lt;G10h4ck&gt; in wireless link we should set DST macaddress to the nextop, and save the real_DST somewhere, maybe in 4 mac address field
[11:39] &lt;nbd&gt; just make a real 4-address wireless link
[11:39] &lt;nbd&gt; then you can treat it as an ethernet link
[11:39] &lt;G10h4ck&gt; or we could encapsulate on wireless only which supports greater mtu, and then decapsulate when forwarding over cabled link
[11:40] &lt;nbd&gt; at some point i was thinking of making a mesh-like mode which runs on top of a regular AP interface and simply creates 4-addr peer station entries/interfaces for its neighbors
[11:40] &lt;nbd&gt; seems like it would fit nicely with what you're trying to do
[11:40] &lt;G10h4ck&gt; also it seems that newer radios doesn'T supports 802,11s that well
[11:40] &lt;nbd&gt; one useful property of this is that it doesn't require special addressing modes used for 802.11s
[11:41] &lt;nbd&gt; it would work with any chipset that has normal mac80211 4-addr support
[11:41] &lt;nbd&gt; and would work with the existing offload features
[11:41] &lt;nbd&gt; e.g. encap offload on mtk chipsets
[11:41] &lt;nbd&gt; with a bit of luck, it wouldn't even need user space changes
[11:41] &lt;nbd&gt; sorry, kernel space changes
[11:42] &lt;nbd&gt; it would work with a modified hostapd
[11:42] &lt;nbd&gt; since all you're doing is creating extra station entries and handling mgmt/auth in user space
[11:42] &lt;G10h4ck&gt; &gt; it would work with any chipset that has normal mac80211 4-addr support&lt; is this supported by most of the chips/drivers ?
[11:42] &lt;nbd&gt; most common ones yes
[11:42] &lt;nbd&gt; ath9k, ath10k, mt76
[11:43] &lt;nbd&gt; it would definitely be a lot faster than 802.11s
[11:45] &lt;G10h4ck&gt; do you think ath11k will be viable for this too ?
[11:45] &lt;G10h4ck&gt; San was investigating 802.11ax radios for librerouter 2
[11:46] &lt;nbd&gt; i think it could work, but i would definitely recommend going with mt7915 instead
[11:46] &lt;nbd&gt; for 802.11ax
[11:46] &lt;G10h4ck&gt; he has been playing with some mt7915e based radios
[11:48] &lt;nbd&gt; from what i hear, ath11k still has a lot of firmware bugs
[11:48] &lt;nbd&gt; and you can't really expect any reasonable support from qualcomm
[11:48] &lt;G10h4ck&gt; so this AP + 4-addr custom mode you suggests seems very interesting
[11:49] &lt;nbd&gt; with mt76, i can forward bug reports directly to mtk
[11:49] &lt;nbd&gt; and they typically have been very responsive when it comes to dealing with firmware issues
[11:49] &lt;G10h4ck&gt; so basically one should configure the radio in this mode on each router, and it would behave more or less like mesh node, but with better performances
[11:49] &lt;nbd&gt; of course somebody would have to write the code for hostapd to do this
[11:50] &lt;nbd&gt; one advantage is that you wouldn't even need a separate interface for meshing anymore. you could piggy-back on a normal ap interface with this
[11:52] &lt;G10h4ck&gt; that would be great
[11:53] &lt;G10h4ck&gt; from what I understand we will be also less dependant on driver support of "more exotic" features like virtual interfaces and 802.11s
[11:53] &lt;G10h4ck&gt; so any radio with good AP support should work well
[11:54] &lt;G10h4ck&gt; do I understand well?</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>[16:21] &lt;nbd&gt; G10h4ck: hi
[16:41] &lt;G10h4ck&gt; hi nbd how are you?
[16:45] &lt;nbd&gt; G10h4ck: fine, thx
[16:45] &lt;nbd&gt; how about you?
[16:48] &lt;G10h4ck&gt; I had some stomachache but now seem going good, also have been reading hostapd code, I have now some undertanding, still I need your suggestion on what should be the flow to add an AP as a station in the station list, AFAIR right now when a station try to associato to our AP an event is bubbled from the kernel to the hostapd code and the hostapd code do a few stuff, authentication etc. then add it in it's station list and call a driver specific callback (
[16:48] &lt;G10h4ck&gt; driver-&gt;add_station or something similar) that in case of mac80211 is NULL so does nothing
[17:05] &lt;G10h4ck&gt; so in case there is another AP, I guess that event is not triggered because the APwill not attempt to associate
[17:07] &lt;G10h4ck&gt; so there is some useful event bubbled to hostapd, for example when a beacon from another AP is received, where we can plug our code which create a station entry or should I "scan" for available AP in another way, and then trigger the station adding code?
[17:09] &lt;nbd&gt; it's been a while since i looked at that part of hostapd
[17:09] &lt;nbd&gt; so i don't have any answers yet
[17:10] &lt;nbd&gt; i don't think you should scan
[17:10] &lt;nbd&gt; beacons should be received already
[17:10] &lt;nbd&gt; for coexistence purposes
[17:10] &lt;nbd&gt; i just don't know in which part of the code
[17:22] &lt;G10h4ck&gt; nbd: so in some part of the code hostapd should receive the beacons from other AP ?
[17:23] &lt;nbd&gt; yes
[17:25] &lt;G10h4ck&gt; so I need to keep digging into hostapd code and then come back with more questions :)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>[14:51] &lt;G10h4ck&gt; nbd It's me getting too old or it's hostapd/wpa_supplicant code utterly convoluted? digging into function calls one and up falling in the white rabbit hole every a couple of them...
[14:53] &lt;dhewg&gt; it's not just you, been there yesterday
[14:56] &lt;G10h4ck&gt; i feel less alone :p</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>[11:41] &lt;G10h4ck&gt; Hi!
[11:42] &lt;G10h4ck&gt; with device tree there is something wone can look at at runtime from userspace to explore the hardware? or it is available only at compile time ?
[11:56] &lt;f00b4r0&gt; G10h4ck: /proc/device-tree
[11:58] &lt;G10h4ck&gt; Great! thanks f00b4r0</pre>
</div>
</div>
<div class="paragraph">
<p>== Suggested reading</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://wireless.wiki.kernel.org/en/users/Documentation/hostapd" class="bare">https://wireless.wiki.kernel.org/en/users/Documentation/hostapd</a></p>
</li>
<li>
<p><a href="https://wireless.wiki.kernel.org/en/developers/documentation/glossary" class="bare">https://wireless.wiki.kernel.org/en/developers/documentation/glossary</a></p>
</li>
</ul>
</div>
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="makefile">Makefile</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="make"><span class="nl">404</span><span class="o">:</span> <span class="nf">Not Found</span></code></pre>
</div>
</div>
</div>
</div>
</div>
      <script src="/assets/js/jquery.js"></script>

<script>
$(document).ready(function() {

    var toc = $('#nav-toc');

    // Select each header
    sections = $('#md-container-pancakes h2');
        $.each(sections, function(idx, v) {
            section = $(v);
            // console.log(section)

            var div_id = $(section).attr('id');
            var div_text = section.text().split('¶')[0];
            var parent = $("#" + div_id)
            var content = '<li id="link_' + div_id + '" class="md-nav__item"><a class="md-nav__link" href="#' + div_id + '" title="' + div_text +'">' + div_text +'</a></li>';
            $(toc).append(content);

            // Add section code to subnavigation
            var children = $('<nav class="md-nav"><ul class="md-nav__list"></nav></ul>')
            var contenders = $("#" + div_id).nextUntil( "h2" );
            $.each(contenders, function(idx, contender){
               if($(contender).is('h2')) {
                   var contender_id = $(contender).attr('id');
                   var contender_text = $(contender).text().split('¶')[0];
                   var content = '<li class="md-nav__item"><a class="md-nav__link" href="#' + contender_id + '" title="' + contender_text +'">' + contender_text +'</a></li>';
                   children.append(content);
                }
             })
             $("#link_" + div_id).append(children);
        });

    });
</script>

      <!-- this will parse through the header fields and add a button to open
     an issue / ask a question on Github. The editable field should be in
     the post frontend matter, and refer to the label to open the issue for -->

<style>
.more {
    float:right;
    font-size: 1.2rem !important;
}
.more:hover {
    color: cornflowerblue !important;
}

.dropdown {
    position: relative;
    display: inline-block;
}

.dropdown i { font-size: 1.6rem !important;}

.dropdown-content {
    display: none;
    position: absolute;
    background-color: #f9f9f9;
    min-width: 160px;
    font-weight: 200;
    box-shadow: 0px 8px 6px 0px rgba(0,0,0,0.2);
    padding: 0px 10px;
    z-index: 1;
    
}

.dropdown:hover .dropdown-content {
    display: block;
}
</style>
<script>
$(document).ready(function() {

    var divs = $("#h1,h2,h3,h4"); 
    $.each(divs, function(i,e){

        // Edit
        var did = $(e).attr('id');
        var start = '<div class="dropdown more"><span><i class="fa fa-ellipsis-h more" title="Edit"></i></span><div class="dropdown-content">';

        // Edit (assuming deployed under main organization repo)
        var link = "https://github.com/libremesh/libremesh.github.io/edit/master/packages/lime-curtigghio.txt#" + did;
        var button = "<p><a href='" + link + "' target='_blank'>Edit this page</a></p>";
        start += button;

        // Issues;
        var link = "https://github.com/libremesh/libremesh.github.io/issues/new?labels=question&title=Question:&body=Question on: https://github.com/libremesh/libremesh.github.io/tree/master/packages/lime-curtigghio.txt%23" + did;

        var button = "<p><a href='" + link + "' target='_blank'>Ask a Question</a></p>";
        start += button;
        start += "</div></div>";
        $(e).append(start)

    })
});
</script>

    </article>
</div>      

                </div>
            </div>
        </main>
    </div>
    <footer class="c-footer md-footer-nav">
  <div class="u-container c-footer__container">
    <nav class="md-footer-nav__inner md-grid">
         
      </nav>
    </div>
  
   <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2025 - LibreMesh
          </div>        
      </div>
      
        
  <div class="md-footer-social">
    <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"> -->
      <a href="https://github.com/libremesh" target="_blank" class="md-footer-social__link fa-brands fa-github"></a>
      <a href="https://matrix.to/#/#libremesh-dev:matrix.guifi.net" target="_blank" class="md-footer-social__link fa fa-comments"></a>
      <a href="https://www.autistici.org/mailman/listinfo/libremesh" target="_blank" class="md-footer-social__link fa fa-envelope"></a>
      
  </div>

    </div>
  </div>

</footer>


    <script>
  var headers = ["h1", "h2", "h3", "h4"]
  var colors = ["var(--color-primary)", "orange", "green", "blue"]
  
  $.each(headers, function(i, header){
    //   var color = colors[i];
      var color = colors[0];
      $(header).each(function () {
          var href=$(this).attr("id");
          $(this).append('<a class="headerlink" style="color:' + color + '" href="#' + href + '" title="Permanent link">¶</a>')
      });
  })
  
  </script>
  
    

  </body>
</html>
